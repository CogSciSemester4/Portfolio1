knitr::opts_chunk$set(echo = TRUE)
#Define the prior
prior <- rep( 1 , dens ) # Flat # prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
#Defining the grid
dens <- 20
p_grid <- seq(from = 0 , to = 1 , length.out = dens)
#Define the prior
prior <- rep( 1 , dens ) # Flat # prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
#Define the prior
#prior <- rep( 1 , dens ) # Flat # prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
prior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance
dens(rbinom(1e4, 6, runif(1e4, 0, 1)))
library(rethinking)
dens(rbinom(1e4, 6, runif(1e4, 0, 1)))
#Compute the likelihood at each value in grid
likelihood <- dbinom( 3 , size = 6 , prob = p_grid )
#Compute the posterior (likelihood by prior)
unstd.posterior <- likelihood * ricprior
#Define the prior
#prior <- rep( 1 , dens ) # Flat
#prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
ricprior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance
#Compute the posterior (likelihood by prior)
unstd.posterior <- likelihood * ricprior
#Standardize the posterior (so it sums to 1)
ricposterior <- unstd.posterior / sum(unstd.posterior)
#Draw the plot
d <- data.frame(grid = p_grid, posterior = ricposterior, prior = ricprior, likelihood = likelihood)
View(d)
ggplot(d, aes(grid,posterior)) +  geom_point() +geom_line()+theme_classic()+  geom_line(aes(grid, prior/dens),color= 'red')+  xlab(”Knowledge of CogSci")+ ylab("posterior probability")
ggplot(d, aes(grid,posterior)) +  geom_point() +geom_line()+theme_classic()+  geom_line(aes(grid, prior/dens),color= 'red')+xlab("Knowledge of CogSci")+ ylab("posterior probability")
dens <- 20
p_grid <- seq(from = 0 , to = 1 , length.out = dens)
#Define the prior
#prior <- rep( 1 , dens ) # Flat
#prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
ricprior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance
#Test the prior (does it look crazy?)
#dens(rbinom(1e4, 6, runif(1e4, 0, 1)))
#dens(rbinom(1e4, 6, runif(1e4, 0.5, 1)))
#dens(rbinom(1e4, 6, rnorm(1e4, 0.5, 0.1)))
#Compute the likelihood at each value in grid
likelihood <- dbinom( 3 , size = 6 , prob = p_grid )
#Compute the posterior (likelihood by prior)
unstd.posterior <- likelihood * ricprior
#Standardize the posterior (so it sums to 1)
ricposterior <- unstd.posterior / sum(unstd.posterior)
#Draw the plot
d <- data.frame(grid = p_grid, posterior = ricposterior, prior = ricprior, likelihood = likelihood)
ggplot(d, aes(grid,posterior)) +  geom_point() +geom_line()+theme_classic()+  geom_line(aes(grid, prior/dens),color= 'red')+xlab("Knowledge of CogSci")+ ylab("posterior probability")
#Probability that Riccardo does
sum(ricposterior[p_grid > 0.5])
#Quadratic approximation
ricquad <- quap(
alist(
C ~ dbinom( C+I ,p) ,  # binomial likelihood
p ~ dunif(0,1)     # uniform prior
), data=list(C=3, I=3) )
#display of the quadratic approximation
precis(ric_quad)
#display of the quadratic approximation
precis(ricquad)
W <- 3
L <- 3
curve( dbeta( x , W+1 , L+1 ) , from=0 , to=1)
#Quadratic approximation
curve( dnorm( x , 0.5 , 0.2 ) , lty=2 , add=TRUE )
## Kristian's knowledge of CogSci
#continuing with dens = 1e4, p_grid and prior
#Testing if the prior looks crazy
dens(rbinom(1e4, 2, runif(1e4, 0, 1)))
#Loading packages
install.packages("pacman")
#Loading packages
install.packages("pacman")
pacman::p_load("rethinking", "tidyverse")
## Kristian's knowledge of Cognitive Science
#grid and density remain the same values
#using the same prior values as before:
krisprior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance, sd = 0.1
kristianlikelihood <- dbinom(2, size = 2, prob = p_grid) #likelihood at each value in grid
kristianunstd.posterior <- kristianlikelihood * krisprior #product of likelihood and prior
kristianposterior <- kris_unstd.posterior / sum(kris_unstd.posterior) #standardizing the posterior so it sums to 1
kristianposterior <- kristianunstd.posterior / sum(kristianunstd.posterior) #standardizing the posterior so it sums to 1
d1 <- data.frame(grid = p_grid, posterior = kristianposterior, prior = krisprior, likelihood = kristianlikelihood)
d1
ggplot(d, aes(p_grid,kristianposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, krisprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Kristian knows more than chance (i.e. area under the curve when "Knowledge of CogSci" is > 0.5)
sum(kris_posterior[p_grid > 0.5]) #65% probability that Kristian Tylén knows more than chance
#Probability that Kristian knows more than chance (i.e. area under the curve when "Knowledge of CogSci" is > 0.5)
sum(kristianposterior[p_grid > 0.5]) #65% probability that Kristian Tylén knows more than chance
## Kristian's knowledge of Cognitive Science
#grid and density remain the same values
#using the same prior values as before:
prior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance, sd = 0.1
kristianunstd.posterior <- kristianlikelihood * prior #product of likelihood and prior
#Define the prior
#prior <- rep( 1 , dens ) # Flat
#prior <- ifelse(p_grid < 0.5 , 0 , 1) # UnreasonablyOptimisticPrior
prior <- dnorm(p_grid, 0.5, 0.1) # SensiblyCenteredAtChance, sd = 0.1
dlikelihood <- dbinom(160, size = 198, prob = p_grid)
dunstd.posterior <- dlikelihood * prior
dposterior <- dunstd.posterior / sum(dunstd.posterior)
d2 <- data.frame(grid = p_grid, posterior = dposterior, prior = prior, likelihood = dlikelihood)
ggplot(d2, aes(p_grid,dposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, prior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Daina knows more than chance:
sum(dposterior[p_grid > 0.5])
mlikelihood <- dbinom(66, size = 132, prob = p_grid)
munstd.posterior <- mlikelihood * prior
mposterior <- munstd.posterior / sum(munstd.posterior)
d3 <- data.frame(grid = p_grid, posterior = dposterior, prior = prior, likelihood = dlikelihood)
ggplot(d2, aes(p_grid,dposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, prior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that mikkel knows more than chance:
sum(dposterior[p_grid > 0.5])
#Probability that mikkel knows more than chance:
sum(mposterior[p_grid > 0.5]) #100% probability that Mikkel knows more than chance
ggplot(d3, aes(p_grid,dposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, prior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
ggplot(d3, aes(p_grid,mposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, prior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
ggplot(d, aes(grid,posterior)) +  geom_point() +geom_line()+theme_classic()+  geom_line(aes(grid, prior/dens),color= 'red')+xlab("Knowledge of CogSci")+ ylab("posterior probability")
ggplot(d3, aes(p_grid,mposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, prior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
newprior <- dnorm(p_grid, 0.8, 0.2)
newriclikelihood <- dbinom(3, size = 6, prob = p_grid) #likelihood
newricunstd.posterior <- newriclikelihood * newprior #product
newricposterior <- newricunstd.posterior / sum(newricunstd.posterior) #standardizing so it sums to 1
d10 <- data.frame(grid = p_grid, posterior = newricposterior, prior = newprior, likelihood = newriclikelihood)
ggplot(d10, aes(p_grid,newricposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
d1
#Probability that Kristian does better than chance in the cognitive science questionnaire
sum(newricposterior[p_grid > 0.5]) #65% probability that Kristian Tylén knows more than chance
newkristianlikelihood <- dbinom(2, size = 2, prob = p_grid) #likelihood
newkristianunstd.posterior <- newkristianlikelihood * newprior #product
newkristianposterior <- newkristianunstd.posterior / sum(newkristianunstd.posterior) #standardizing so it sums to 1
d11 <- data.frame(grid = p_grid, posterior = newkristianposterior, prior = newprior, likelihood = newkristianlikelihood)
ggplot(d, aes(p_grid,newkristianposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
d11
#Probability that Kristian does better than chance in the cognitive science questionnaire
sum(newkristianposterior[p_grid > 0.5]) #65% probability that Kristian Tylén knows more than chance
newdlikelihood <- dbinom(160, size = 198, prob = p_grid)
newdunstd.posterior <- newdlikelihood * newprior
newdposterior <- newdunstd.posterior / sum(newdunstd.posterior)
d12 <- data.frame(grid = p_grid, posterior = newdposterior, prior = newprior, likelihood = newdlikelihood)
ggplot(d2, aes(p_grid,newdposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Daina knows more than chance:
sum(newdposterior[p_grid > 0.5]) #100% probability that Daina Crafa knows more than chance
d12 <- data.frame(grid = p_grid, posterior = newdposterior, prior = newprior, likelihood = newdlikelihood)
ggplot(d12, aes(p_grid,newdposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
newmlikelihood <- dbinom(66, size = 132, prob = p_grid)
newmunstd.posterior <- newmlikelihood * newprior
newmposterior <- newmunstd.posterior / sum(newmunstd.posterior)
d13 <- data.frame(grid = p_grid, posterior = newmposterior, prior = newprior, likelihood = newmlikelihood)
ggplot(d13, aes(p_grid,newmposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that mikkel knows more than chance:
sum(newmposterior[p_grid > 0.5]) #50% probability that Mikkel knows more than chance
## Riccardo's knowledge of Cognitive Science
#grid, prior and density remain the same values
#However, sample is multiplied by 100
extriclikelihood <- dbinom(300, size = 600, prob = p_grid) #likelihood
extricunstd.posterior <- extriclikelihood * newprior #product
extricposterior <- extricunstd.posterior / sum(extricunstd.posterior) #standardizing so it sums to 1
d20 <- data.frame(grid = p_grid, posterior = extricposterior, prior = newprior, likelihood = extriclikelihood)
ggplot(d20, aes(p_grid,extricposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Riccardo does better than chance in the cognitive science questionnaire
sum(extricposterior[p_grid > 0.5]) #84% probability that Riccardo knows more than chance. This must be based primarily on the prior as the only 50% of the questions in the observed data is correctly answered
extriclikelihood <- dbinom(300, size = 600, prob = p_grid) #likelihood
extricunstd.posterior <- extriclikelihood * newprior #product
extricposterior <- extricunstd.posterior / sum(extricunstd.posterior) #standardizing so it sums to 1
d20 <- data.frame(grid = p_grid, posterior = extricposterior, prior = newprior, likelihood = extriclikelihood)
ggplot(d20, aes(p_grid,extricposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Riccardo does better than chance in the cognitive science questionnaire
sum(extricposterior[p_grid > 0.5]) #Now there is only 60% chance because of the bigger samplesize interferes more with the prior probabilities
extkristianlikelihood <- dbinom(200, size = 200, prob = p_grid) #likelihood
extkristianunstd.posterior <- extkristianlikelihood * newprior #product
extkristianposterior <- extkristianunstd.posterior / sum(extkristianunstd.posterior) #standardizing so it sums to 1
d11 <- data.frame(grid = p_grid, posterior = extkristianposterior, prior = newprior, likelihood = extkristianlikelihood)
ggplot(d11, aes(p_grid,extkristianposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Kristian does better than chance in the cognitive science questionnaire
sum(extkristianposterior[p_grid > 0.5]) #98% probability that Kristian Tylén knows more than chance
extdlikelihood <- dbinom(16000, size = 19800, prob = p_grid)
extdunstd.posterior <- newdlikelihood * newprior
newdposterior <- extdunstd.posterior / sum(extdunstd.posterior)
d22 <- data.frame(grid = p_grid, posterior = extdposterior, prior = newprior, likelihood = extdlikelihood)
extdlikelihood <- dbinom(16000, size = 19800, prob = p_grid)
extdunstd.posterior <- newdlikelihood * newprior
extdposterior <- extdunstd.posterior / sum(extdunstd.posterior)
d22 <- data.frame(grid = p_grid, posterior = extdposterior, prior = newprior, likelihood = extdlikelihood)
ggplot(d22, aes(p_grid,extdposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that Daina knows more than chance:
sum(extdposterior[p_grid > 0.5]) #100% probability that Daina Crafa knows more than chance
#Probability that Kristian does better than chance in the cognitive science questionnaire
sum(extkristianposterior[p_grid > 0.5]) #100% probability that Kristian Tylén knows more than chance
extmlikelihood <- dbinom(6600, size = 13200, prob = p_grid)
extmunstd.posterior <- extmlikelihood * newprior
extmposterior <- extmunstd.posterior / sum(extmunstd.posterior)
d23 <- data.frame(grid = p_grid, posterior = extmposterior, prior = newprior, likelihood = extmlikelihood)
ggplot(d23, aes(p_grid,extmposterior)) +geom_point() +geom_line()+theme_classic()+  geom_line(aes(p_grid, newprior/dens),color= 'red')+  xlab("Knowledge of CogSci") + ylab("posterior probability")
#Probability that mikkel knows more than chance:
sum(extmposterior[p_grid > 0.5]) #63% probability that Mikkel knows more than chance
#Probability that mikkel knows more than chance:
sum(newmposterior[p_grid > 0.5]) #63% probability that Mikkel knows more than chance
